%    \begin{macrocode}
%<!COPYRIGHT>
\ProvidesPackage{fileparse}[%
%<!DATE>
%<!VERSION>
%<*DRIVER>
    2099/01/01 develop
%</DRIVER>
    fileparse]
%    \end{macrocode}
%
%
%

\begingroup
\catcode`\/=12
\catcode`\.=12

\newcommand*{\fileparse}{}
\gdef\fileparse#1{%
    \edef\fileparsepath{#1}%
    \@onelevel@sanitize\fileparsepath
    \let\fileparsearea\@empty
    \let\fileparsedir\@empty
    \let\fileparsebase\@gobble
    \let\fileparsedotext\@empty
    \let\fileparseext\fileparsedefaultext
    \iftrue\expandafter\fileparse@dir\fileparsepath/\fi
}
%
\gdef\fileparsedirsep{/}
\gdef\fileparsefilesep{.}
\gdef\fileparsedefaultext{tex}
%
\gdef\fileparse@dir#1/#2\fi{%
    \fi
    \ifx\@nnil#2\@nnil
        \def\fileparsename{#1}%
        \expandafter\fileparse@filename@
    \else
        \edef\fileparsedir{\fileparsedir#1/}%
        \fileparse@dir#2%
    \fi
}
%
\gdef\fileparse@filename@{%
    \ifx\fileparsename\@empty
        \let\fileparsebase\@empty
        \ifx\fileparsedefaultext\relax
            \let\fileparseext\relax
        \else
            \let\fileparseext\@empty
        \fi
    \else
        \expandafter\fileparse@filename\fileparsename.%
    \fi
}
%
\gdef\fileparse@filename#1.#2\fi{%
    \fi
    \ifx\@nnil#2\@nnil
        \ifx\fileparsebase\@gobble
            \def\fileparsebase{#1}%
        \else
            \def\fileparseext{#1}%
        \fi
        \def\fileparsedotext{.\fileparseext}%
    \else
        \edef\fileparsebase{\fileparsebase.#1}%
        \fileparse@filename#2%
    \fi
}
%

\endgroup

